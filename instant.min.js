!function(a){"use strict";var b={a:"àáâãäå",e:"èéêë",i:"ìíîï",o:"òóôõö",u:"ùúûü",c:"ç",n:"ñ",A:"ÀÁÂÃÄÅ",E:"ÈÉÊË",I:"ÌÍÎÏ",O:"ÒÓÔÕÖ",U:"ÙÚÛÜ",C:"Ç",N:"Ñ"},c=function(a){var c=a;for(var d in b){var e=new RegExp("["+b[d]+"]","g");c=c.replace(e,d)}return c};a.instant=function(b,d){var e=this;e.$el=a(b),e.$wrapper=!1,e.$list=!1,e.$hiddenInput=!1,e.set=a.extend({accentsInsensitive:!0,attributes:{},callback:!1,caseInsensitive:!0,formName:"hidden-"+e.$el.attr("name"),defaultValue:!1,listOptions:{},prepare:!1},d),e.$el.attr("data-options")&&a.extend(e.set.listOptions,e.$el.data("options")),e.$el.attr("data-value")&&(e.set.defaultValue=e.$el.data("value")),e.createDOM=function(){e.$wrapper=a("<span>").addClass("instant_wrapper"),e.$list=a("<ul>").addClass("instant_list"),e.$hiddenInput=a("<input>").attr({name:e.set.formName,type:"hidden",value:e.set.defaultValue}),e.$el.attr(e.set.attributes),e.$el.wrap(e.$wrapper),e.$el.after(e.$list,e.$hiddenInput)},e.generateList=function(){e.$list.empty();for(var b in e.set.listOptions){var c=a("<li>");c.attr("value",b).text(e.set.listOptions[b]),e.$list.append(c)}},e.browseList=function(b){e.set.caseInsensitive&&(b=b.toLowerCase()),e.set.accentsInsensitive&&(b=c(b));var d=e.$list.find("li");d.each(function(){var d=a(this),f=d.text();e.set.caseInsensitive&&(f=f.toLowerCase()),e.set.accentsInsensitive&&(f=c(f)),-1!==f.indexOf(b)?d.addClass("visible").show():d.removeClass("visible").hide()}),d.removeClass("focus"),d.filter(".visible").first().addClass("focus")},e.init=function(){"function"==typeof e.set.prepare&&e.set.prepare(e),e.createDOM(),e.generateList()},e.init()},a.fn.instant=function(b){return this.each(function(){var c=new a.instant(this,b);c.$el.on("focusin",function(){c.$list.show();var a=c.$list.find("li");a.is(".focus")||a.filter(":visible:first").addClass("focus")}).on("focusout",function(){c.$list.hide()}).on("keydown",function(a){var b=c.$list.find(".focus"),d={13:function(){b.trigger("select")},38:function(){var a=c.$list.find("li:visible:first");b.is(a)||b.removeClass("focus").prevAll(":visible").first().addClass("focus")},40:function(){var a=c.$list.find("li:visible:last");b.is(a)||b.removeClass("focus").nextAll(":visible").first().addClass("focus")}};if(void 0!==d[a.which])return a.preventDefault(),d[a.which](),!1}).on("keyup",function(b){if(13==b.which||38==b.which||40==b.which)return b.preventDefault(),!1;c.$hiddenInput.val("");var d=c.$el.val();c.browseList(d);var e=c.$list.find("li"),f=e.filter(".visible").first();0!==f.length?(c.$list.show(),a(f).addClass("focus").siblings().removeClass("focus")):(c.$list.hide(),c.$list.find(".focus").removeClass("focus"))}).on("setValue",function(a,b,d){c.$list.hide(),c.$hiddenInput.val(b),"function"==typeof c.set.callback&&c.set.callback(c,b,d)}),c.$list.on("select","li",function(){c.$el.val(a(this).text()).trigger("setValue",a(this).val(),a(this).text())}).on("mousedown","li",function(b){a(this).trigger("select")}).on("mouseover","li",function(){a(this).addClass("focus").siblings().removeClass("focus")})})}}(jQuery);
